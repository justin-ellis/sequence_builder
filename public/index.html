<!DOCTYPE html>
<html ng-app="sequence-builder">
<head>
	<title>Sequence Builder</title>
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="./css/style.css">
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>
	<script type="text/javascript" src="js/app.js"></script>
	<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
	<body ng-controller="mainController as ctrl">

<!-- Navbar begins  -->

<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Yoga Bloom</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="dropdown"><a ng-if="!ctrl.loggedIn" href="#" ng-click="ctrl.displayLogin()">{{ctrl.loggedOutButton}}<span class="sr-only">(current)</span></a></li>
        <li ng-click="ctrl.logout()"><a ng-click="ctrl.displayLogin()" ng-if="ctrl.loggedIn" href="#">{{ctrl.loggedInButton}}</a> </li>
        <li><a ng-click="ctrl.displayLogin()" href="#">Register</a></li>
        <li class="dropdown">
          <a href="#"  class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Display Options <span class="caret"></span></a>
          <ul class="dropdown-menu">
                       <button ng-class="{'showingDetails' : ctrl.showName, 'hidingDetails' : !ctrl.showName}" class="list-group-item list-group-item" ng-click="ctrl.toggleDetails('name')">
			<span ng-if="ctrl.showName">{{ctrl.hideToggle}} Name</span>
			<span ng-if="!ctrl.showName">{{ctrl.showToggle}} Name</span>
		</button>
		<button ng-class="{'showingDetails' : ctrl.showSanskrit, 'hidingDetails' : !ctrl.showSanskrit}" class="buttonst-group-item list-group-item" ng-click="ctrl.toggleDetails('sanskrit')">
			<span ng-if="ctrl.showSanskrit">{{ctrl.hideToggle}} Sanskrit</span>
			<span ng-if="!ctrl.showSanskrit">{{ctrl.showToggle}} Sanskrit</span>
		</button>
		<button ng-class="{'showingDetails' : ctrl.showPicture, 'hidingDetails' : !ctrl.showPicture}" class="buttonst-group-item list-group-item" ng-click="ctrl.toggleDetails('picture')">
			<span ng-if="ctrl.showPicture">{{ctrl.hideToggle}} Picture</span>
			<span ng-if="!ctrl.showPicture">{{ctrl.showToggle}} Picture</span>
		</button>
		<button ng-class="{'showingDetails' : ctrl.showCategory, 'hidingDetails' : !ctrl.showCategory}" class="buttonst-group-item list-group-item" ng-click="ctrl.toggleDetails('category')">
			<span ng-if="ctrl.showCategory">{{ctrl.hideToggle}} Category</span><span ng-if="!ctrl.showCategory">{{ctrl.showToggle}} Category</span>
		</button>
		<button ng-class="{'showingDetails' : ctrl.showDescription, 'hidingDetails' : !ctrl.showDescription}" class="list-group-item buttonst-group-item" ng-click="ctrl.toggleDetails('description')"><span id="descShow" ng-if="ctrl.showDescription">{{ctrl.hideToggle}} Cues</span>
			<span ng-if="!ctrl.showDescription">{{ctrl.showToggle}} Cues</span>
		</button>
		<button ng-class="{'showingDetails' : ctrl.showBenefits, 'hidingDetails' : !ctrl.showBenefits}" class="buttonst-group-item list-group-item" ng-click="ctrl.toggleDetails('benefits')">
			<span ng-if="ctrl.showBenefits">{{ctrl.hideToggle}} Benefits</span>
			<span ng-if="!ctrl.showBenefits">{{ctrl.showToggle}} Benefits</span>
		</button>
          </ul>
        </li>
      </ul>
      <form class="navbar-form navbar-left">
        <div class="form-group">
          <input type="text" ng-model="nameFilter" placeholder="Search Yoga Bloom">
        </div>
        <!-- <button type="submit" class="btn btn-default">Submit</button> -->
      </form>
      <ul class ="nav navbar-nav">
      	<li ><a ng-if="ctrl.showSequence" ng-click="ctrl.toggleSequences();" href="#">{{ctrl.hide}} Sequences</a></li>
         <li ><a ng-if="!ctrl.showSequence" ng-click="ctrl.toggleSequences();" href="#">{{ctrl.show}} Sequences</a></li>
      </ul>
      <!-- <ul class="nav navbar-nav navbar-right"> -->
        
        <!-- <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="#">Action</a></li>
            <li><a href="#">Another action</a></li>
            <li><a href="#">Something else here</a></li>
            <li role="separator" class="divider"></li>
            <li><a href="#">Separated link</a></li>
          </ul>
        </li> -->
      <!-- </ul> -->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<!-- Nav bar ends -->


<!-- Register/login button begin -->
<!-- 		<div id="loginDiv"> 
			<button class="btn btn-default" ng-click="ctrl.displayLogin()">Register or Log In</button>
			<button ng-if="ctrl.loggedIn" ng-click="ctrl.logout()">Log out</button>
		</div> -->
<!-- Register/login button end -->








<!-- Create a sequence form begin -->
	<div id="loginDiv" ng-if="ctrl.loggedIn">
		<h3>Create a sequence:</h3>
		<form ng-submit="ctrl.createSequence()">
				Name: <input type="text" ng-model="ctrl.name"/>
	Difficulty: <input type="text" ng-model="ctrl.difficulty"/>
							<input type="submit" ng-click="ctrl.getSequences()" value="Create"/>
		</form>

	</div>
<!-- Create a sequence form end -->


<!-- Register/login form begin -->
	<div class="form-group" id="loginDiv" ng-hide="ctrl.concealLogin">
		<form ng-submit="ctrl.login()" ng-if="ctrl.showLogin">
			<h2>Log In</h2>
				Username: <input class="form-control" type="text" ng-model="ctrl.username"/>
				Password: <input class="form-control" type="text" ng-model="ctrl.password"/>
			<input class="btn btn-default" type="submit" ng-click="ctrl.hideLogin()" value="Log in"/>
		</form>

		<form ng-if="ctrl.showLogin" ng-submit="ctrl.registerUser()">
			<h2>Register</h2>
			Username: <input class="form-control" type="text" ng-model="ctrl.registeredUsername"/>
			Password: <input class="form-control" type="text" ng-model="ctrl.registeredPassword"/>
			<input class="btn btn-default" type="submit" ng-click="ctrl.hideLogin()" value="Register"/>
		</form>
	</div>
<!-- Register/login form end -->




<!-- Filtered Poses toggle buttons begin -->
	<!-- <div>
		<button ng-class="{'showingDetails' : ctrl.showName, 'hidingDetails' : !ctrl.showName}" class="btn btn-primary" ng-click="ctrl.toggleDetails('name')">
			<span ng-if="ctrl.showName">{{ctrl.hideToggle}} Name</span>
			<span ng-if="!ctrl.showName">{{ctrl.showToggle}} Name</span>
		</button>
		<button ng-class="{'showingDetails' : ctrl.showSanskrit, 'hidingDetails' : !ctrl.showSanskrit}" class="btn btn-primary" ng-click="ctrl.toggleDetails('sanskrit')">
			<span ng-if="ctrl.showSanskrit">{{ctrl.hideToggle}} Sanskrit</span>
			<span ng-if="!ctrl.showSanskrit">{{ctrl.showToggle}} Sanskrit</span>
		</button>
		<button ng-class="{'showingDetails' : ctrl.showPicture, 'hidingDetails' : !ctrl.showPicture}" class="btn btn-primary" ng-click="ctrl.toggleDetails('picture')">
			<span ng-if="ctrl.showPicture">{{ctrl.hideToggle}} Picture</span>
			<span ng-if="!ctrl.showPicture">{{ctrl.showToggle}} Picture</span>
		</button>
		<button ng-class="{'showingDetails' : ctrl.showCategory, 'hidingDetails' : !ctrl.showCategory}" class="btn btn-primary" ng-click="ctrl.toggleDetails('category')">
			<span ng-if="ctrl.showCategory">{{ctrl.hideToggle}} Category</span><span ng-if="!ctrl.showCategory">{{ctrl.showToggle}} Category</span>
		</button>
		<button ng-class="{'showingDetails' : ctrl.showDescription, 'hidingDetails' : !ctrl.showDescription}" class="btn btn-primary" ng-click="ctrl.toggleDetails('description')"><span ng-if="ctrl.showDescription">{{ctrl.hideToggle}} Description</span>
			<span ng-if="!ctrl.showDescription">{{ctrl.showToggle}} Description</span>
		</button>
		<button ng-class="{'showingDetails' : ctrl.showBenefits, 'hidingDetails' : !ctrl.showBenefits}" class="btn btn-primary" ng-click="ctrl.toggleDetails('benefits')">
			<span ng-if="ctrl.showBenefits">{{ctrl.hideToggle}} Benefits</span>
			<span ng-if="!ctrl.showBenefits">{{ctrl.showToggle}} Benefits</span>
		</button>
	</div> -->
	<!-- Filtered poses toggle buttons end  -->







<!-- Repeating created sequences begin -->
	<div ng-if="ctrl.showSequence" ng-if="ctrl.loggedIn" data-ng-repeat="sequence in ctrl.sequences track by $index">
			
		<ul class="list-group">

				Sequence Name: <li class="list-group-item">{{sequence.name}}</li>
				Difficulty: <li class="list-group-item">{{sequence.difficulty}}</li>
				Creator: <li class="list-group-item">{{sequence.author}}</li>

		<!-- Repeating poses that have been added to sequence begin -->

				<li class="list-group-item sequenceLi">
		<div id="sequencePoses" class="container-fluid" data-ng-repeat="key in sequence.poses track by $index">
				 <!-- <button class = "btn btn-sm btn-danger" ng-click="ctrl.deleteAsana(key);">Delete</button> -->
				 {{key.pose_name}}<br/><div class= view hm-zoom">
				 <img class="img-fluid" alt="" id ="sequencePicture" ng-src="{{key.file_reference}}">  <div id="absolute"><button ng-if="!ctrl.checkDeleteButton() && sequence.author === ctrl.activeUsername;" class = "btn btn-sm btn-danger" id="experiment" ng-click="ctrl.deleteAsana(key);">Delete</button></div></img> <div class="mask flex-center"><p class="red-text"></p></div> </div>
			</div>
		</li>
				<button ng-if="ctrl.loggedIn" ng-click="ctrl.editSequenceIndex = $index; ctrl.showForm();">Edit Sequence</button>
		</ul>

		<!-- Repeating poses that have been added to sequence begin -->

		<!-- Edit sequence name and difficulty form begin -->
			<div ng-hide="ctrl.hideForm">

				<form ng-if="$index === ctrl.editSequenceIndex" ng-submit="ctrl.editSequence(sequence);">
	       Name<input type="text"  ng-model="ctrl.updatedName" placeholder="name"/>
	       Difficulty<input type="text"  ng-model="ctrl.updatedDifficulty" placeholder=""/>
	       <input type="submit" value="edit sequence">
	       </form>
<!-- ng-if="ctrl.checkSequenceAuthors();" -->
	      <button  ng-click="ctrl.deleteSequence(sequence)">Delete Sequence</button>
				</div>
		<!-- Edit sequence name and difficulty form end -->
	</div>
<!-- Repeating created sequences end -->

<!-- retrieving req.session.username from server begin -->
<!-- 	<button ng-click="ctrl.getUsers();">Get Username</button>
	{{ctrl.activeUsername}} -->
<!-- retrieving req.session.username from server end -->

	<button ng-click="ctrl.checkSequenceAuthors();">get authors for sequences</button>


	<div id="loginDiv" class="filterSelect">
	<h4> Search Postures:</h4>

	<select class="selectpicker" ng-model="difficultyFilter"
		data-ng-options="difficulty.difficulty as difficulty.name for difficulty in ctrl.asanaDifficulties">
			<option value selected="selected">All Difficulties</option>
	</select>


	<select class="selectpicker" ng-model="categoryFilter"
		data-ng-options="category.category as category.name for category in ctrl.asanaCategories">
			<option value selected="selected">All Categories</option>
	</select>

	<input type="text" placeholder="Downward Dog" ng-model="nameFilter">
	</div>

<div class="container-fluid center">
	<div id="poseDiv" data-ng-repeat="pose in (ctrl.filteredPostures = (ctrl.postures | filter:(!!difficultyFilter || undefined) && {difficulty: difficultyFilter}  | filter: (!!categoryFilter || undefined) && {category: categoryFilter} | filter: nameFilter))">


		
		<ul class="list-group">
			<li ng-show="ctrl.showName" class="list-group-item">{{pose.pose_name}} </li>
<!-- ng-if="ctrl.checkSequenceAuthors();" -->


			<li ng-if="ctrl.checkSequenceAuthors();" class="list-group-item"> <button class="btn btn-warning" ng-click="ctrl.createAsana($index);">Add Pose</button> </li>
			<li ng-show="ctrl.showSanskrit" class="list-group-item">

				<p id="sanskrit-name" ng-show="!isHidden" ng-click="isHidden = true">{{pose.sanskrit_name}}</p>
				
				<span id="sanskrit-translation" ng-show="isHidden" ng-click="isHidden = false" ng-show="isHidden">{{pose.translation.join(", ")}}</span>
			</li>
			 <li ng-show="ctrl.showPicture" class="list-group-item"> <img class="posePicture" ng-src="{{pose.file_reference}}"/> </li>
			 <li id="descScroll" ng-show="ctrl.showDescription" class="list-group-item" > {{pose.description.join(", ")}} </li>
			<li ng-show="ctrl.showCategory" class="list-group-item" >Category: {{pose.category}} </li>
			<li id="descScroll" ng-show="ctrl.showBenefits" class="list-group-item" >Benefits: {{pose.benefits}} </li>
			<li ng-show="ctrl.showDifficulty" class="list-group-item">Difficulty: {{pose.difficulty}}</li>
		</ul>
	</div>
</div>
	</body>
</html>